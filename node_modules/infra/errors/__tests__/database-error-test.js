/**
 * Created by kyle on 6/4/16.
 */

jest.unmock('../database-error');

describe('node_modules/infra/error/database-error.js', function(){

    it('should be able to create fully functional DatabaseError object', function() {
        var DatabaseError = require('../database-error');

        var err = new DatabaseError('It went bad!', 'sql query', [1]);

        // The name property should be set to the error's name
        expect(err.name).toEqual('DatabaseError');

        // The error should be an instance of its class
        expect(err instanceof DatabaseError).toBeTruthy();

        // The error should be an instance of builtin Error
        expect(err instanceof Error).toBeTruthy();

        // The error should have recorded a stack
        expect(err.stack).toBeDefined();

        // toString should return the default error message formatting
        expect(err.toString()).toEqual('DatabaseError: It went bad!');

        // The stack should start with the default error message formatting
        expect(err.stack.split('\n')[0]).toEqual('DatabaseError: It went bad!');

        // The extra property should have been set
        expect(err.query).toEqual('sql query');
        expect(err.values).toEqual([1]);
    });
} );
