/**
 * Created by huunguyen on 6/4/15.
 */
var crypto = require('crypto');
var config = require('utils/config');
var symestricAlgorithm = 'aes-256-ctr';
var securityPassword = config['INSPIUS_PRIVATE_STRING'];

var security = {
    secureHash: function (message){
        var hash = crypto.createHmac('sha512', securityPassword);
        hash.update(message);
        return hash.digest('hex');
    },

    generateTimedToken: function (message){
        return security.secureHash(new Date().toTimeString() + message);
    },

    makeSalt: function(){
        return Math.round((new Date().valueOf() * Math.random())) + '';
    },

    encryptPassword: function (raw_pass, salt){
        if (!raw_pass) return '';
        try{
            return crypto
                    .createHmac('sha1', salt)
                    .update(raw_pass)
                    .digest('hex'); 
        }catch(err){
            return '';
        }
    }
};

module.exports = security;
